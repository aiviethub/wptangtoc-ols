#!/bin/bash
echo ""
echo ""
echo ""
echo "========================================================================="
echo "|Sao luu & khoi phuc => Xoa file sao luu Backup		                  |"
echo "========================================================================="
. /etc/wptt/.wptt.conf
. /etc/wptt/tenmien
echo ""
echo ""
echo "Lua chon website ban muon xoa file sao luu Backup: "
echo ""
lua_chon_NAME

pathcheck="/etc/wptt/vhost/.$NAME.conf"
if [[ ! -f "$pathcheck" || "$NAME" = "0" ]]; then
	clear
	. /etc/wptt/wptt-backup-restore-main
	exit
fi

echo "/-----------------------------------------------------------------------/"
echo "Xoa file backup trong thu muc: /usr/local/backup-website/$NAME"
echo "/-----------------------------------------------------------------------/"

selects=()
for entry in $(ls -A /usr/local/backup-website/$NAME); do
	selects+=("$entry")
done

PS3="
-//- Nhap lua chon cua ban [0=Thoat]: "
select select in ${selects[@]}; do
	file=$select
	break
done
pathcheck="/usr/local/backup-website/$NAME"
before_delete=$(du -hs "$pathcheck")

if [[ "$file" = "" ]]; then
	clear
	echo "Khong co file nao ton tai trong thu muc /usr/local/backup-website/$NAME"
	exit
	sleep 3
fi

duong_dan_thu_muc="/usr/local/backup-website/$NAME/$file"

read -p "Ban co muon xoa file backup $file? (y/n): " dongy

if [[ "$dongy" = "y" ]]; then
	rm -f $duong_dan_thu_muc
	echo "Hoan thanh qua trinh xoa file backup website"
	echo "==================================================================="
	echo "Dung luong thu muc truoc khi xoa	: $before_delete"
	echo "Dung luong thu muc sau khi xoa		: $(du -hs $pathcheck)"
	echo "==================================================================="
fi
