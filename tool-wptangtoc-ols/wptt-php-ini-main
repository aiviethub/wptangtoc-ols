#!/bin/bash
clear
. /etc/wptt/.wptt.conf
RED='\033[0;31m'
NC='\033[0m'
ols1=$(systemctl status lsws.service | grep 'Active' | cut -f2 -d':' | xargs | cut -f1 -d' ' | xargs)
mariadb1=$(systemctl status mariadb.service | grep 'Active' | cut -f2 -d':' | xargs | cut -f1 -d' ' | xargs)

if [[ "$ols1" = "loaded" ]]; then
    ols="Hoat dong tot"
else
    echo "========================================================================="
    ols2="Webserver LiteSpeed dang bi gap su co"
    echo "========================================================================="
fi

if [[ "$mariadb1" = "active" ]]; then
    mariadb="Hoat dong tot"
else
    echo "========================================================================="
    mariadb2="MariaDB Database dang bi gap su co"
    echo "========================================================================="
fi

echo -e "${RED}+------------------------------------------------------------------------+"
echo "|                        WPTANGTOC OLS phien ban: $version_wptangtoc_ols		 |"
echo "|                          Phat trien boi: Gia Tuan			 |"
echo -e "+------------------------------------------------------------------------+ ${NC}"
echo "========================================================================="
if [[ "$ols1" = "active" && "$mariadb1" = "active" ]]; then
    hoatdong="hoat dong tot"
else
    hoatdong="may chu dang co van de, can phai khac phuc"
    echo "$mariadb2"
    echo "$ols2"
fi
echo "Tinh trang may chu: $hoatdong"
echo "-------------------------------------------------------------------------"
echo "Huong dan: https://wptangtoc.com/wptangtoc-ols-huong-dan/"
echo "-------------------------------------------------------------------------"
echo ""
echo ""
echo "Quan ly PHP:"
echo ""
options=(
  "Uploads max php.ini"            #1
  "Khoi phuc uploads max php.ini"  #2
  "Cau hinh PHP.ini"               #3
  "Khoi phuc PHP.ini"              #4
  "Thay doi version phien ban php" #5
  "Kich hoat ioncube PHP"          #6
  "Huy Kich hoat ioncube PHP"      #7
  "Cai lai PHP"                    #8
)
PS3="
Nhap lua chon cua ban (1-${#options[@]}) [0=Thoat]: "
select opt in "${options[@]}"; do
  case $opt in

  "${options[0]}")
    "/etc/wptt/php/wptt-php-ini-uploads"
    ;;
  "${options[1]}")
    "/etc/wptt/php/wptt-khoi-phuc-sua-phpini"
    ;;
  "${options[2]}")
    "/etc/wptt/php/wptt-sua-phpini"
    ;;
  "${options[3]}")
    "/etc/wptt/php/wptt-khoi-phuc-sua-phpini"
    ;;
  "${options[4]}")
    "/etc/wptt/php/wptt-php-version"
    ;;

  "${options[5]}")
    "/etc/wptt/php/wptt-ioncube"
    ;;

  "${options[6]}")
    "/etc/wptt/php/wptt-xoa-ioncube"
    ;;

  "${options[7]}")
    "/etc/wptt/php/wptt-cai-lai-php"
    ;;
  *) wptangtoc ;;
  esac
done
