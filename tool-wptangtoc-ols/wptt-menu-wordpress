#!/bin/bash
clear
. /etc/wptt/.wptt.conf
RED='\033[0;31m'
NC='\033[0m'
ols1=$(systemctl status lshttpd.service | grep 'enabled' | cut -f2 -d':' | xargs | cut -f1 -d' ' | xargs)
mariadb1=$(systemctl status mariadb.service | grep 'Active' | cut -f2 -d':' | xargs | cut -f1 -d' ' | xargs)

if [[ "$ols1" = "loaded" ]]; then
  ols="Hoat dong tot"
else
  echo "========================================================================="
  ols2="Websever LiteSpeed dang bi gap su co"
  echo "========================================================================="
fi

if [[ "$mariadb1" = "active" ]]; then
  mariadb="Hoat dong tot"
else
  echo "========================================================================="
  mariadb2="MariaDB Database dang bi gap su co"
  systemctl restart mariadb.service
  echo "========================================================================="
fi

echo -e "${RED}+-----------------------------------------------------------------------+"
echo "|                        WPTANGTOC OLS phien ban: $version_wptangtoc_ols		|"
echo "|                          Phat trien boi: Gia Tuan			|"
echo -e "+-----------------------------------------------------------------------+ ${NC}"
echo "========================================================================="
if [[ "$ols1" = "loaded" && "$mariadb1" = "active" ]]; then
  hoatdong="hoat dong tot"
else
  hoatdong="May chu dang co van de, can phai khac phuc"
  echo "$mariadb2"
  echo "$ols2"
fi
echo "Tinh trang may chu: $hoatdong"
echo "-------------------------------------------------------------------------"
echo "Huong dan: https://wptangtoc.com/wptangtoc-ols-huong-dan/"
echo "-------------------------------------------------------------------------"
echo ""
echo ""
echo "Quan ly WordPress:"
echo ""
options=(
  "Tai Ma Nguon wordpress"                               #1
  "Xoa cache"                                            #2
  "Xoa tat ca cache vps"                                 #3
  "Cap nhat wordpress core"                              #4
  "Cap nhat plugins"                                     #5
  "Cap nhat themes"                                      #6
  "Cai lai reinstall wordpress core"                     #7
  "Cai lai reinstall wordpress (core + plugin + themes)" #8
  "Cap nhat wordpress all vps (core + plugin + themes)"  #9
  "Xoa Cache website wordpress"                          #10
  "Toi uu database"                                      #11
  "Sua chua database"                                    #12
  "Chuyen doi database myisam to innodb"                 #13
  "Tai plugin LiteSpeed Cache"                           #14
  "Tat sua code truc tiep tren wp-admin wordpress"       #15
  "Xoa binh luan spam"                                   #16
  "Truy van va thay the co so du lieu"                   #17
  "Bat che do bao tri"                                   #18
  "Tat che do bao tri"                                   #19
  "Toi uu hoa hinh anh"                                  #20
  "Kich hoat LScache"                                    #21
  "Huy kich hoat LScache"                                #22
  "Unix stocket config database"                         #23
  "Toi uu hoa wp-cron"                                   #24
  "Tat toi uu hoa wp-cron"                               #25
  "Tang muc gioi han ram wordpress"                      #26
  "Thay doi salt cookie dang nhap"                       #27
  "Tat wp debug wordpress"                               #28
  "Bat wp debug wordpress"                               #29
  "Toi uu heartbeat api"                                 #30
  "Tat XML RPC wordpress"                                #31
  "Bao mat 2 lop wp-admin"                               #32
  "Tat bao mat 2 lop wp-admin"                           #33
  "Doi password wp-admin wordpress"                      #34
  "Tai ma nguon wordpress"                               #35
  "Xoa transient database"                               #36
  "Thay doi tien to database"                            #37
  "Toi uu ALL database"                                  #38
  "Rewrite permalink"                                    #39
  "Reset lai ve wordpress moi hoan toan"                 #40
  "Tai tao lai Thumbnail"                                #41
  "Clear cache && Preload WP Rocket"                     #42
  "Kham Suc khoe wordpress"                              #43
  "Kiem tra autoload"                                    #44
  "Cap nhat Url home va siteurl"                         #45
  "Kiem tra phien ban wordpess"                          #46
  "Kiem tra bao mat ma nguon decode base64"              #47
  "Sua chua database ALL"                                #48
)

PS3="
Nhap lua chon cua ban (1-${#options[@]}) [0=Thoat]: "
select opt in "${options[@]}"; do
  case $opt in

  "${options[0]}")
    "/etc/wptt/wptt-install-wordpress2"
    ;;
  "${options[1]}")
    "/etc/wptt/wordpress/wptt-xoacache"
    ;;
  "${options[2]}")
    "/etc/wptt/wordpress/xoa-cache-full"
    ;;
  "${options[3]}")
    "/etc/wptt/wordpress/update-core"
    ;;
  "${options[4]}")
    "/etc/wptt/wordpress/update-plugin"
    ;;
  "${options[5]}")
    "/etc/wptt/wordpress/update-theme"
    ;;
  "${options[6]}")
    "/etc/wptt/wordpress/ghi-de-wordpress-core"
    ;;
  "${options[7]}")
    "/etc/wptt/wordpress/wptt-update-reinstall-wordpres"
    ;;
  "${options[8]}")
    "/etc/wptt/wordpress/update-full"
    ;;

  "${options[9]}")
    "/etc/wptt/wordpress/wptt-xoacache"
    ;;
  "${options[10]}")
    "/etc/wptt/wordpress/toi-uu-dabatabase"
    ;;

  "${options[11]}")
    "/etc/wptt/wordpress/sua-chua-database"
    ;;
  "${options[12]}")
    "/etc/wptt/wordpress/chuyen-myisam"
    ;;

  "${options[13]}")
    "/etc/wptt/wordpress/tai-plugin-litespeed-cache"
    ;;
  "${options[14]}")
    "/etc/wptt/wordpress/tat-chinh-sua-truc-tiep-admin-wordpress"
    ;;
  "${options[15]}")
    "/etc/wptt/wordpress/xoa-binh-luan-spam"
    ;;
  "${options[16]}")
    "/etc/wptt/wordpress/query-truyvan"
    ;;

  "${options[17]}")
    "/etc/wptt/wordpress/bat-baotri"
    ;;
  "${options[18]}")
    "/etc/wptt/wordpress/tat-baotri"
    ;;
  "${options[19]}")
    "/etc/wptt/wordpress/image"
    ;;
  "${options[20]}")
    "/etc/wptt/wordpress/lscache"
    ;;

  "${options[21]}")
    "/etc/wptt/wordpress/huy-lscache"
    ;;

  "${options[22]}")
    "/etc/wptt/wordpress/unix-stocket-wpconfig"
    ;;

  "${options[23]}")
    "/etc/wptt/wordpress/wp-cron-job"
    ;;

  "${options[24]}")
    "/etc/wptt/wordpress/tat-wp-cron-job"
    ;;

  "${options[25]}")
    "/etc/wptt/wordpress/tang-gioi-han-ram-wordpress"
    ;;

  "${options[26]}")
    "/etc/wptt/wordpress/thay-salt"
    ;;

  "${options[27]}")
    "/etc/wptt/wordpress/wp-debug"
    ;;

  "${options[28]}")
    "/etc/wptt/wordpress/bat-wp-debug"
    ;;

  "${options[29]}")
    "/etc/wptt/wordpress/plugin-heartbeat-wptangtoc"
    ;;

  "${options[30]}")
    "/etc/wptt/wordpress/plugin-xml-rpc-wptangtoc"
    ;;
  "${options[31]}")
    "/etc/wptt/wordpress/bao-mat-2lop"
    ;;

  \
    "${options[32]}")
    "/etc/wptt/wordpress/tat-bao-mat-2lop"
    ;;

  \
    "${options[33]}")
    "/etc/wptt/wordpress/passwd-wp"
    ;;

  \
    "${options[34]}")
    "/etc/wptt/wptt-install-wordpress"
    ;;

  "${options[35]}")
    "/etc/wptt/wordpress/transient"
    ;;
  "${options[36]}")
    "/etc/wptt/wordpress/thay-doi-tien-to"
    ;;
  "${options[37]}")
    "/etc/wptt/wordpress/all-database"
    ;;
  "${options[38]}")
    "/etc/wptt/wordpress/rewrite"
    ;;
  "${options[39]}")
    "/etc/wptt/wordpress/wptt-wipe-wordpress"
    ;;
  "${options[40]}")
    "/etc/wptt/wordpress/wptt-render-thumbnail"
    ;;

  "${options[41]}")
    "/etc/wptt/wordpress/wptt-rocket"
    ;;
  "${options[42]}")
    "/etc/wptt/wordpress/kham-suc-khoe-wordpress"
    ;;

  "${options[43]}")
    "/etc/wptt/wordpress/check-autoload"
    ;;

  "${options[44]}")
    "/etc/wptt/wordpress/thay-url-option"
    ;;

  "${options[45]}")
    "/etc/wptt/wordpress/kiem-tra-version-wp"
    ;;

  "${options[46]}")
    "/etc/wptt/wordpress/check-decode-base64"
    ;;

  "${options[47]}")
    "/etc/wptt/wordpress/all-database-sua-chua"
    ;;
  *) wptangtoc ;;
  esac
done
