#!/bin/bash
# @author: Gia Tu·∫•n
# @since: 2025

function huong_dan(){
T√≠nh nƒÉng Qu·∫£n l√Ω Chuy·ªÉn Website [Website Migration] trong WPTangToc OLS l√† m·ªôt t·∫≠p h·ª£p c√°c c√¥ng c·ª• v√† quy tr√¨nh ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ gi√∫p b·∫°n di chuy·ªÉn website [ƒë·∫∑c bi·ªát l√† WordPress] t·ª´ m·ªôt n∆°i n√†y sang n∆°i kh√°c m·ªôt c√°ch d·ªÖ d√†ng v√† √≠t l·ªói h∆°n. üööüí®

Gi·ªõi thi·ªáu ng·∫Øn g·ªçn:
M·ª•c ƒë√≠ch: ƒê∆°n gi·∫£n h√≥a qu√° tr√¨nh chuy·ªÉn website gi·ªØa c√°c m√°y ch·ªß, t·ª´ nh√† cung c·∫•p n√†y sang nh√† cung c·∫•p kh√°c, ho·∫∑c t·ª´ m√¥i tr∆∞·ªùng ph√°t tri·ªÉn [staging] l√™n m√°y ch·ªß ch√≠nh [production] v√† ng∆∞·ª£c l·∫°i.

L·ª£i √≠ch:
 * Gi·∫£m thi·ªÉu l·ªói th·ªß c√¥ng: T·ª± ƒë·ªông h√≥a nhi·ªÅu b∆∞·ªõc ph·ª©c t·∫°p trong qu√° tr√¨nh di chuy·ªÉn.
 * Ti·∫øt ki·ªám th·ªùi gian: TƒÉng t·ªëc ƒë·ªô di chuy·ªÉn website so v·ªõi vi·ªác l√†m th·ªß c√¥ng ho√†n to√†n.
 * ƒê·∫£m b·∫£o t√≠nh to√†n v·∫πn: Gi√∫p di chuy·ªÉn ƒë·∫ßy ƒë·ªß c·∫£ t·ªáp tin v√† c∆° s·ªü d·ªØ li·ªáu m·ªôt c√°ch nh·∫•t qu√°n.
 * Thu·∫≠n ti·ªán: Cung c·∫•p m·ªôt quy tr√¨nh t√≠ch h·ª£p ngay trong c√¥ng c·ª• qu·∫£n l√Ω m√°y ch·ªß quen thu·ªôc.
T√≠nh nƒÉng n√†y gi√∫p qu√° tr√¨nh chuy·ªÉn nh√† cho website c·ªßa b·∫°n tr·ªü n√™n m∆∞·ª£t m√† v√† √≠t cƒÉng th·∫≥ng h∆°n, ƒë·∫£m b·∫£o website ho·∫°t ƒë·ªông ·ªïn ƒë·ªãnh tr√™n m√¥i tr∆∞·ªùng m·ªõi.
}


if [[ $1 = "" ]];then
. /etc/wptt/wptt-header-menu
header_menu
else
	. /etc/wptt/echo-color
echoDo "=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-="
fi

. /etc/wptt/.wptt.conf
if [[ $ngon_ngu = '' ]];then
	ngon_ngu='vi'
fi
. /etc/wptt/lang/$ngon_ngu.sh

echo ""
echo ""
echo "$chuyen_website:"
echo ""
options=(
    "$chuyen_website_ben_ngoai_ve_wptangtoc"                       #1
	"$chuyen_tat_ca_website_wptangtoc_ve_wptangtoc_ols"
	"$chuyen_tat_ca_website_wptangtoc_ols_ve_wptangtoc_bang_rsync"
	"$chuyen_1_website_wptangtoc_ols_ve_wptangtoc_ols_bang_rsync"
)
# H√†m th·ª±c thi h√†nh ƒë·ªông d·ª±a tr√™n index (cho menu Chuy·ªÉn website)
run_action() {
    local index=$1
    local script_path=""
    local script_args="" # Tham s·ªë s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t trong case, c√≥ th·ªÉ r·ªóng

    case $index in
         0) script_path="/etc/wptt/chuyen-web/wptt-chuyen-website";      script_args="" ;; # Kh√¥ng c√≥ tham s·ªë
         1) script_path="/etc/wptt/chuyen-web/wptt-chuyen-website-all"; script_args="" ;; # Kh√¥ng c√≥ tham s·ªë
         2) script_path="/etc/wptt/chuyen-web/rsync-move";              script_args="" ;; # Kh√¥ng c√≥ tham s·ªë
         3) script_path="/etc/wptt/chuyen-web/rsync-move-only";         script_args="98" ;;
        *) echo "${lua_chon_khong_hop_le:-L·ª±a ch·ªçn kh√¥ng h·ª£p l·ªá}: Index $index."; return 1 ;;
    esac

    # Ki·ªÉm tra v√† ch·∫°y script con
    if [[ -x "$script_path" ]]; then
        # Ki·ªÉm tra xem c√≥ c·∫ßn truy·ªÅn tham s·ªë hay kh√¥ng
        if [[ -n "$script_args" ]]; then
            "$script_path" "$script_args" # G·ªçi v·ªõi tham s·ªë
        else
            "$script_path"                # G·ªçi kh√¥ng c√≥ tham s·ªë
        fi
    else
        echo "L·ªói: Kh√¥ng t√¨m th·∫•y ho·∫∑c kh√¥ng th·ªÉ th·ª±c thi script '$script_path'."
    fi
    # read -rp "Nh·∫•n Enter ƒë·ªÉ quay l·∫°i menu..." # B·ªè comment n·∫øu mu·ªën t·∫°m d·ª´ng
}
. /etc/wptt/wptt-callback-menu-chon

