#!/bin/bash
echo ""
echo ""
echo ""
echo "========================================================================="
echo "|Chuyen website ALL ve WPTangToc OLS						                  |"
echo "========================================================================="
echo "Luu y: tinh nay nay chi ho tro tren he thong cung hoat dong voi WPTangToc OLS voi nhau"
echo "Yeu cau webserver cu cua ban phai co ho tro terminal"
echo "dan paste doan lenh nay vao terminal webserver cu cua ban: "
echo "Lenh: curl -sO https://wptangtoc.com/share/wptt-all && bash wptt-all"
echo ""
read -p "Xac nhan da hoan tat chay lenh tren hoan tat sao luu du lieu ben webserver cu va tiep tuc chay lenh (y/n): " dongy

. /etc/wptt/.wptt.conf

read -p "Nhap ten domain vps cu website chinh: " domain_download_list
cd
wget $domain_download_list/danh_sach_website_wptangtoc_ols.txt

if [[ ! -f danh_sach_website_wptangtoc_ols.txt ]];then
echo "Xac nhan khong nhap vps chinh cu khong chinh xac"
exit
fi

domain_them=($(cat danh_sach_website_wptangtoc_ols.txt))

domain_trung_lap=($(ls -A /etc/wptt/vhost | sed 's/^.//' | sed 's/.conf//'))

if [ "$(ls -A /etc/wptt/vhost)" ]; then
  echo
  echo '--------------------------------------------------'
  for NAME in ${domain_them[@]}; do
	if [[ ! " ${domain_trung_lap[@]} " =~ " ${NAME} " ]];then
		echo "Them domain $NAME vao WPTangToc OLS"
		wptt them-website $NAME
	fi
		. /etc/wptt/wptt-chuyen-website $NAME 1
		echo "Chuyen Hoan tat website $NAME"
  done
  echo '--------------------------------------------------'
  echo
fi

cd && rm -f danh_sach_website_wptangtoc_ols.txt

  echo '--------------------------------------------------'
. /etc/wptt/domain/wptt-list-domain
echo "Hoan tat chuyen toan bo website vao vps moi"
