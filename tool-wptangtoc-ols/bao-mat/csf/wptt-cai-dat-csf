#!/bin/bash
echo "========================================================================="
echo "|Quản lý bảo mật => CSF => Cài Đặt                                      |"
echo "========================================================================="

if [[ ! -f /etc/csf/csf.conf ]];then
yum install perl-libwww-perl.noarch perl-Time-HiRes -y
cd /usr/src/
if [[ -f /usr/src/csf.tgz ]];then
rm -f /usr/src/csf.tgz
fi

wget https://download.configserver.com/csf.tgz --no-check-certificate
tar -xzf csf.tgz
cd csf
sh install.sh
cd /usr/local/csf/bin/
perl csftest.pl
systemctl stop firewalld
systemctl disable firewalld
systemctl mask firewalld

sed -i 's/TESTING = "1"/TESTING = "0"/g' /etc/csf/csf.conf

# sed -i '/TESTING = /d' /etc/csf/csf.conf
# sed -i '/while this is enable/a TESTING = "0"' /etc/csf/csf.conf
systemctl start csf
systemctl start lfd
systemctl enable csf
systemctl enable lfd
echo "Hoàn tất cài đặt CSF"
else
echo "Bạn đã cài đặt trước đó rồi"
fi

check_menu_wptangtoc_active=$1
if [[ $check_menu_wptangtoc_active = "98" ]];then
. /etc/wptt/bao-mat/csf-main 1
fi

