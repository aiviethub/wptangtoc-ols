#!/bin/bash
clear
export LC_ALL=en_US.UTF-8
export LANG=en_US.UTF-8
read -p "Nhập domain hoặc subdomain bạn muốn thêm 
    (ví dụ: wptangtoc.com, abc.wptangtoc.com ...) : " NAME

sed -i "/keyFile/d" /usr/local/lsws/conf/httpd_config.conf
sed -i "/certFile/d" /usr/local/lsws/conf/httpd_config.conf
sed -i "/CACertFile/d" /usr/local/lsws/conf/httpd_config.conf
sed -i "/https/a keyFile              \/etc\/letsencrypt\/live\/$NAME\/privkey.pem" /usr/local/lsws/conf/httpd_config.conf
sed -i "/https/a certFile             \/etc\/letsencrypt\/live\/$NAME\/cert.pem" /usr/local/lsws/conf/httpd_config.conf
sed -i "/https/a CACertFile           \/etc\/letsencrypt\/live\/$NAME\/chain.pem" /usr/local/lsws/conf/httpd_config.conf

. /etc/wptt/wptt-themwebsite $NAME

sed -i "/$Website_chinh/d" /etc/wptt/.wptt.conf
echo "Website_chinh=$NAME" >>/etc/wptt/.wptt.conf
. /etc/wptt/.wptt.conf
. /etc/wptt/vhost/.wptangtoc-ols.com.conf
mysql -u $database_admin_username -p"$database_admin_password" -e "DROP DATABASE ${DB_Name_web}"
mysql -u $database_admin_username -p"$database_admin_password" -e "DROP USER '${DB_User_web}'@'localhost'"

rm -rf /usr/local/lsws/conf/vhosts/wptangtoc-ols.com >/dev/null 2>&1
rm -rf /usr/local/lsws/wptangtoc-ols.com >/dev/null 2>&1
userdel wptangtocwpolswpcom >/dev/null 2>&1
rm -rf wptangtocwpolswpcom >/dev/null 2>&1
rm -rf /wptangtoc-ols/wptangtoc-ols.com >/dev/null 2>&1
sed -i '/wptt-thay-domain-chinh-wptangtoc-ols-com/d' /root/.bashrc
echo "-------------------------------------------------------------------------"
echo "webserver sẽ khởi động lại."
echo "-------------------------------------------------------------------------"
reboot


