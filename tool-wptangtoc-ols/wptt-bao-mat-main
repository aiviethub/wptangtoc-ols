#!/bin/bash
clear
. /etc/wptt/.wptt.conf
RED='\033[0;31m'
NC='\033[0m'
ols1=$(systemctl status lsws.service | grep 'Active' | cut -f2 -d':' | xargs | cut -f1 -d' ' | xargs)
mariadb1=$(systemctl status mariadb.service | grep 'Active' | cut -f2 -d':' | xargs | cut -f1 -d' ' | xargs)

if [[ "$ols1" = "active" ]]; then
    ols="Hoat dong tot"
else
    echo "========================================================================="
    ols2="Webserver LiteSpeed dang bi gap su co"
    echo "========================================================================="
fi

if [[ "$mariadb1" = "active" ]]; then
    mariadb="Hoat dong tot"
else
    echo "========================================================================="
    mariadb2="MariaDB Database dang bi gap su co"
    echo "========================================================================="
fi

echo -e "${RED}+------------------------------------------------------------------------+"
echo "|                        WPTANGTOC OLS phien ban: $version_wptangtoc_ols		 |"
echo "|                          Phat trien boi: Gia Tuan			 |"
echo -e "+------------------------------------------------------------------------+ ${NC}"
echo "========================================================================="
if [[ "$ols1" = "active" && "$mariadb1" = "active" ]]; then
    hoatdong="hoat dong tot"
else
    hoatdong="may chu dang co van de, can phai khac phuc"
    echo "$mariadb2"
    echo "$ols2"
fi
echo "Tinh trang may chu: $hoatdong"
echo "-------------------------------------------------------------------------"
echo "Huong dan: https://wptangtoc.com/wptangtoc-ols-huong-dan/"
echo "-------------------------------------------------------------------------"
echo ""
echo ""
echo "Bao Mat:"
echo ""
options=(
    "Kich Hoat ModSecurity"                                                                #1
    "Huy Kich Hoat ModSecurity"                                                            #2
    "Kich hoat chong Brute Force WordPress"                                                #3
    "Huy kich hoat chong Brute Force WordPress"                                            #4
    "Danh sach IP bi khoa Brute Force WordPress"                                           #5
    "Mo khoa IP Brute Force WordPress"                                                     #6
    "Kich hoat Hotlinking"                                                                 #7
    "Them domain vuot qua Hotlinking"                                                      #8
    "Huy kich hoat Hotlinking"                                                             #9
    "Kich hoat bao mat 2 lop WordPress"                                                    #10
    "Huy kich hoat bao mat 2 lop WordPress"                                                #11
    "Xem thong tin tai khoan bao mat 2 lop"                                                #12
    "Scan quet virus domain"                                                               #13
    "Scan quet virus ALL domain"                                                           #14
    "Xoa phan mem diet virus"                                                              #15
    "Thiet lap telegram chat"                                                              #16
    "Thiet lap thong bao login SSH"                                                        #17
    "Thiet lap canh bao downtime website"                                                  #18
    "Kich hoat chong DDOS website"                                                         #19
    "Huy kich hoat chong DDOS website"                                                     #20
    "Thiet lap canh bao telegram khi sap het tai nguyen may chu"                           #21
    "Thiet lap canh bao service ngung hoat dong qua telegram va tu dong reboot service do" #22
)

PS3="
Nhap lua chon cua ban (1-${#options[@]}) [0=Thoat]: "
select opt in "${options[@]}"; do
    case $opt in
    "${options[0]}")
        "/etc/wptt/bao-mat/wptt-modsecurity"
        ;;
    "${options[1]}")
        "/etc/wptt/bao-mat/wptt-tat-modsecurity"
        ;;
    "${options[2]}")
        "/etc/wptt/bao-mat/wptt-admin-bao-mat"
        ;;
    "${options[3]}")
        "/etc/wptt/bao-mat/wptt-admin-xoa"
        ;;
    "${options[4]}")
        "/etc/wptt/bao-mat/wptt-admin-danh-sach-block"
        ;;
    "${options[5]}")
        "/etc/wptt/bao-mat/wptt-admin-mo-khoa"
        ;;

    "${options[6]}")
        "/etc/wptt/bao-mat/wptt-hotlinking"
        ;;

    "${options[7]}")
        "/etc/wptt/bao-mat/add-domain-hotlinking"
        ;;

    "${options[8]}")
        "/etc/wptt/bao-mat/wptt-xoa-hotlinking"
        ;;

    "${options[9]}")
        "/etc/wptt/wordpress/bao-mat-2lop"
        ;;
    "${options[10]}")
        "/etc/wptt/wordpress/tat-bao-mat-2lop"
        ;;

    "${options[11]}")
        "/etc/wptt/bao-mat/wptt-kiem-tra-tai-khoan-bao-mat-2lop"
        ;;
    "${options[12]}")
        "/etc/wptt/bao-mat/wptt-scan-virus"
        ;;

    "${options[13]}")
        "/etc/wptt/bao-mat/wptt-scan-virus-all-domain"
        ;;

    "${options[14]}")
        "/etc/wptt/bao-mat/wptt-scan-virus-xoa-phan-mem"
        ;;
    "${options[15]}")
        "/etc/wptt/bao-mat/wptt-telegram"
        ;;
    "${options[16]}")
        "/etc/wptt/bao-mat/thong-bao-login-ssh"
        ;;

    "${options[17]}")
        "/etc/wptt/bao-mat/wptt-canh-bao-downtime-thiet-lap"
        ;;

    "${options[18]}")
        "/etc/wptt/bao-mat/wptt-canh-bao-ddos-thiet-lap"
        ;;

    "${options[19]}")
        "/etc/wptt/bao-mat/wptt-canh-bao-ddos-thiet-lap-xoa"
        ;;

    "${options[20]}")
        "/etc/wptt/bao-mat/wptt-thong-bao-het-tai-nguyen-thiet-lap"
        ;;

    "${options[21]}")
        "/etc/wptt/reboot-app/wptt-auto-reboot-thiet-lap"
        ;;
    *) wptangtoc ;;
    esac
done
