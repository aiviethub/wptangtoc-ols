#!/bin/bash
# @author: Gia Tuấn
# @website: https://wptangtoc.com
# @since: 2022

echo "========================================================================="
echo "|Quản lý Cache => Hủy kích hoạt Memcached                               |"
echo "========================================================================="

if [[ ! -f /etc/sysconfig/memcached ]];then
echo "Bạn chưa kích hoạt đã kích hoạt memcached"
. /etc/wptt/wptt-cache-main 1
fi


read -p "Bạn có muốn xóa cài đặt object cache Memcached không (y/n): " dongy

if [[ $dongy != 'y' ]];then
. /etc/wptt/wptt-cache-main 1
exit
fi


systemctl stop memcached.service
systemctl disable memcached.service
yum remove memcached -y

if [[ ! -d /usr/local/lsmcd ]];then
lsphp=($(ls /usr/local/lsws | grep 'lsphp' | sed 's/^lsphp//g'))
for phpmemcached in ${lsphp[@]};do
yum remove lsphp${phpmemcached}-pecl-memcached -y
done
fi

rm -rf /usr/local/lsws/memcached
systemctl restart lsws

. /etc/wptt/echo-color
echoDone "Hoàn tất hủy cài đặt object cache memcached"

check_menu_wptangtoc_active=$1
if [[ $check_menu_wptangtoc_active = "98" ]];then
. /etc/wptt/wptt-cache-main 1
fi

