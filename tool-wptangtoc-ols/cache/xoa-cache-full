#!/bin/bash
echo ""
echo ""
echo ""
echo "========================================================================="
echo "|Quản lý Cache => Xóa toàn bộ cache trên hệ thống                       |"
echo "========================================================================="
echo ""
echo ""
read -p "Bạn có muốn xóa toàn bộ cache trên hệ thống vps này? (y/n): " renew
. /etc/wptt/echo-color
if [[ "$renew" = "y" ]]; then
	if [ "$(ls -At /etc/wptt/vhost)" ]; then
		i=1
		for entry in $(ls -A /etc/wptt/vhost); do
			NAME=$(echo $entry | sed 's/^.//' | sed 's/.conf//')
			path="/usr/local/lsws/$NAME/html"
			if [[ ! -f $path/wp-load.php ]];then
			echo "Xóa cache cho website $NAME không thành công"
			echo "Tính năng này chỉ hỗ trợ trên website WordPress"
			continue
			fi

			_runing "Xóa cache website $NAME"
. /etc/wptt/cache/wptt-xoacache $NAME >/dev/null 2>&1
			_rundone "Xóa cache website $NAME"
		done
	fi
fi

check_menu_wptangtoc_active=$1
if [[ $check_menu_wptangtoc_active = "98" ]];then
. /etc/wptt/wptt-cache-main 1
fi

