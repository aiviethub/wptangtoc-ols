#!/bin/bash

function huong_dan() {
  WPTangToc OLS c√≥ t√≠nh nƒÉng t·∫Øt XML-RPC WordPress, th√¨ ƒë√¢y l√† m·ªôt bi·ªán ph√°p b·∫£o m·∫≠t v√† t·ªëi ∆∞u h√≥a quan tr·ªçng, gi√∫p b·∫°n v√¥ hi·ªáu h√≥a t·ªáp xmlrpc.php tr√™n c√°c website WordPress c·ªßa m√¨nh.

  XML-RPC l√† g√¨?
  * xmlrpc.php l√† m·ªôt t·ªáp tin trong WordPress, ho·∫°t ƒë·ªông nh∆∞ m·ªôt Giao di·ªán L·∫≠p tr√¨nh ·ª®ng d·ª•ng [API]. N√≥ cho ph√©p c√°c ·ª©ng d·ª•ng v√† d·ªãch v·ª• b√™n ngo√†i k·∫øt n·ªëi v√† th·ª±c hi·ªán c√°c h√†nh ƒë·ªông tr√™n website WordPress c·ªßa b·∫°n t·ª´ xa [v√≠ d·ª•: ƒëƒÉng b√†i t·ª´ ƒëi·ªán tho·∫°i, nh·∫≠n th√¥ng b√°o pingback/trackback, k·∫øt n·ªëi v·ªõi c√°c d·ªãch v·ª• nh∆∞ Jetpack].

  üéØ T·∫°i sao c·∫ßn t·∫Øt XML-RPC?
  * TƒÉng c∆∞·ªùng B·∫£o m·∫≠t: ƒê√¢y l√† l√Ω do ch√≠nh. xmlrpc.php l√† m·ªôt m·ª•c ti√™u t·∫•n c√¥ng r·∫•t ph·ªï bi·∫øn:
  * T·∫•n c√¥ng Brute-Force: K·∫ª t·∫•n c√¥ng c√≥ th·ªÉ th·ª≠ h√†ng ng√†n m·∫≠t kh·∫©u qua xmlrpc.php ƒë·ªÉ d√≤ t√†i kho·∫£n admin.
  * T·∫•n c√¥ng DDoS [Khu·∫øch ƒë·∫°i]: L·ª£i d·ª•ng t√≠nh nƒÉng pingback ƒë·ªÉ t·∫•n c√¥ng c√°c website kh√°c.
  * Qu√©t v√† Thu th·∫≠p Th√¥ng tin: B·ªã l·ª£i d·ª•ng ƒë·ªÉ t√¨m ki·∫øm ng∆∞·ªùi d√πng ho·∫∑c th√¥ng tin kh√°c.
  * Gi·∫£m t·∫£i Server: V√¥ hi·ªáu h√≥a xmlrpc.php gi√∫p ngƒÉn ch·∫∑n c√°c truy c·∫≠p kh√¥ng mong mu·ªën t·ª´ bot v√† k·∫ª t·∫•n c√¥ng, gi·∫£m b·ªõt g√°nh n·∫∑ng kh√¥ng c·∫ßn thi·∫øt cho m√°y ch·ªß.
  * Kh√¥ng c√≤n C·∫ßn thi·∫øt: V·ªõi s·ª± ph√°t tri·ªÉn c·ªßa REST API trong WordPress, nhi·ªÅu ch·ª©c nƒÉng c·ªßa XML-RPC ƒë√£ tr·ªü n√™n l·ªói th·ªùi ho·∫∑c √≠t ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªëi v·ªõi nhi·ªÅu website hi·ªán ƒë·∫°i.

  T√≥m l·∫°i: T√≠nh nƒÉng t·∫Øt xmlrpc.php trong WPTangToc OLS l√† m·ªôt c√¥ng c·ª• h·ªØu √≠ch gi√∫p b·∫°n gia c·ªë b·∫£o m·∫≠t v√† gi·∫£m t·∫£i cho website WordPress b·∫±ng c√°ch lo·∫°i b·ªè m·ªôt c·ªïng giao ti·∫øp th∆∞·ªùng b·ªã l·ª£i d·ª•ng ƒë·ªÉ t·∫•n c√¥ng. ƒê√¢y l√† m·ªôt trong nh·ªØng b∆∞·ªõc b·∫£o m·∫≠t c∆° b·∫£n ƒë∆∞·ª£c khuy·∫øn ngh·ªã cho h·∫ßu h·∫øt c√°c website WordPress hi·ªán nay, mi·ªÖn l√† b·∫°n kh√¥ng c√≤n ph·ª• thu·ªôc v√†o c√°c ch·ª©c nƒÉng c·ªßa XML-RPC.
}

echo ""
echo ""
echo ""
echo "========================================================================="
echo "|Qu·∫£n l√Ω WordPress => T·∫Øt xml-rpc WordPress                              |"
echo "========================================================================="
. /etc/wptt/tenmien
echo ""
echo ""
echo "L·ª±a ch·ªçn website b·∫°n mu·ªën t·∫Øt xml-rpc WordPress: "
echo ""
lua_chon_NAME

. /etc/wptt/echo-color
if [[ "$NAME" = "0" || "$NAME" = "" ]]; then
  . /etc/wptt/wptt-wordpress-main 1
fi

pathcheck="/etc/wptt/vhost/.$NAME.conf"
if [[ ! -f "$pathcheck" ]]; then
  clear
  echoDo "T√™n mi·ªÅn kh√¥ng t·ªìn t·∫°i tr√™n h·ªá th·ªëng n√†y"
  sleep 3
  . /etc/wptt/wptt-wordpress-main 1
  exit
fi

pathcheckwp="/usr/local/lsws/$NAME/html/wp-load.php"
if [[ ! -f "$pathcheckwp" ]]; then
  clear
  echoDo "H·ªá th·ªëng x√°c nh·∫≠n b·∫°n kh√¥ng s·ª≠ d·ª•ng WordPress"
  echoDo "T√≠nh nƒÉng n√†y ch·ªâc√≥ th·ªÉ ho·∫°t ƒë·ªông tr√™n WordPress"
  sleep 3
  . /etc/wptt/wptt-wordpress-main 1
  exit
fi

. /etc/wptt/vhost/."$NAME".conf

pathcheckplugin="/usr/local/lsws/$NAME/html/wp-content/plugins/xml-rpc-wptangtoc"
if [[ -d "$pathcheckplugin" ]]; then
  echoDo "ban da kich hoat tat xml-rpc wordpress roi"
  . /etc/wptt/wptt-wordpress-main 1
fi

read -p "B·∫°n mu·ªën t·∫Øt xml rpc wordpress (y/n): " check
if [[ "$check" = "y" ]]; then
  . /etc/wptt/php/php-cli-domain-config $NAME

  _runing "T·∫Øt xml rpc WordPress cho website $NAME"
  chown -R "$User_name_vhost":"$User_name_vhost" /usr/local/lsws/"$NAME"/html/wp-content/plugins/xml-rpc-wptangtoc
  cd /usr/local/lsws/"$NAME"/html/wp-content/plugins/xml-rpc-wptangtoc && find . -type d -exec chmod 755 {} \;
  cd /usr/local/lsws/"$NAME"/html/wp-content/plugins/xml-rpc-wptangtoc && find . -type f -exec chmod 644 {} \;
  _rundone "T·∫Øt xml rpc WordPress cho website $NAME"
fi
check_menu_wptangtoc_active=$1
if [[ $check_menu_wptangtoc_active = "98" ]]; then
  . /etc/wptt/wptt-wordpress-main 1
fi
