#!/bin/bash
echo ""
echo ""
echo ""
echo "========================================================================="
echo "|Quan ly WordPress => Xoa toan bo cache tren may chu                    |"
echo "========================================================================="
echo ""
echo ""
read -p "Ban co muon xoa cache tat ca cac website tren vps nay? (y/n): " renew
if [[ "$renew" = "y" ]]; then
	if [ "$(ls -At /etc/wptt/vhost)" ]; then
		i=1
		for entry in $(ls -A /etc/wptt/vhost); do
			NAME=$(echo $entry | sed 's/^.//' | sed 's/.conf//')
			path="/usr/local/lsws/$NAME/html"
			echo "Dang tien hanh xoa cache cho website $NAME"
			cd "$path"
			wp cache flush --allow-root --path="$path"
			wp rewrite flush --allow-root --path="$path"
			wp litespeed-purge all --allow-root --path="$path"
		done
	fi
fi

echo "Qua trinh clear all cache hoan tat"
