#!/bin/bash
echo ""
echo ""
echo ""
echo "==================================================================================="
echo "|Quan ly WordPress => tat chinh sua giao dien code truc tiep tren wordpress admin |                               "
echo "==================================================================================="
. /etc/wptt/tenmien
echo ""
echo ""

echo "lua chon website ban muon tat chinh sua giao dien code truc tiep tren wordpress admin:"
echo ""
lua_chon_NAME
pathcheck="/etc/wptt/vhost/.$NAME.conf"
if [[ ! -f "$pathcheck" || "$NAME" = "0" ]]; then
    clear
    . /etc/wptt/wptt-wordpress-main
    exit
fi

pathcheckwp="/usr/local/lsws/$NAME/html/wp-load.php"
if [[ ! -f "$pathcheckwp" ]]; then
  clear
  echo "He thong xac nhan ban chua kich hoat su dung WordPress"
  sleep 3
  . /etc/wptt/wptt-wordpress-main 1
  exit
fi



read -p "Xác nhận kích hoạt tắt sửa code trực tiếp trên wp-admin (y/n): " dongy
if [[ "$dongy" = "y" ]]; then

. /etc/wptt/echo-color
wp_config="/usr/local/lsws/$NAME/html/wp-config.php"
if [[ ! -f $wp_config ]];then
echoDo "không xác định được file wp-config của website $NAME"
. /etc/wptt/wptt-wordpress-main 1
fi

_runing "Tắt sửa code trực tiếp trên wp-admin"
sed -i "/DISALLOW_FILE_EDIT/d" "$wp_config"
sed -i "/DISALLOW_FILE_MODS/d" "$wp_config"
sed -i "/<?php/a define( 'DISALLOW_FILE_EDIT', true);" "$wp_config"
sed -i "/<?php/a define( 'DISALLOW_FILE_MODS', true);" "$wp_config"
_rundone "Tắt sửa code trực tiếp trên wp-admin"
fi

check_menu_wptangtoc_active=$1
if [[ $check_menu_wptangtoc_active = "98" ]];then
. /etc/wptt/wptt-wordpress-main 1
fi

